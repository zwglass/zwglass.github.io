(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"9wds":function(e,t,a){},VYaB:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return i}));var n=a("q1tI"),r=a.n(n),o=a("Sm+g"),c=["admin-customer/v1/customer","admin-wxinfo/v1/customerwxinfo"],s=function(e){var t=e.requestCount,a=e.reqObject,n=e.responseDataHandle,s=c[0];return r.a.createElement(o.a,{responseDataHandle:n,api:s,method:"post",reqParams:{},reqObject:a,requestCount:t})};s.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var u=function(e){var t=e.customerOrWx,a=e.customerOrWxId,s=e.requestCount,u=e.reqObject,l=e.responseDataHandle,i=Object(n.useRef)(c[t]+"/"+a);return Object(n.useEffect)((function(){i.current=c[t]+"/"+a}),[t,a]),r.a.createElement(o.a,{responseDataHandle:l,api:i.current,method:"put",reqParams:{},reqObject:u,requestCount:s})};u.defaultProps={customerOrWx:0,customerOrWxId:0,requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var l=function(e){var t=e.customerId,a=e.responseDataHandle,c=Object(n.useState)(0),s=c[0],u=c[1],l=Object(n.useRef)({id:t}),i=Object(n.useRef)({});return Object(n.useEffect)((function(){l.current={id:t},u(s+1)}),[t]),r.a.createElement(o.a,{responseDataHandle:a,api:"admin-customer/v1/customer",method:"get",reqParams:l.current,reqObject:i.current,requestCount:s})};l.defaultProps={customerId:0,responseDataHandle:function(e){console.log(e)}};var i=function(e){var t=e.customerId,a=e.responseDataHandle,c=Object(n.useState)(0),s=c[0],u=c[1],l=Object(n.useRef)({customer_id:t}),i=Object(n.useRef)({});return Object(n.useEffect)((function(){t>0&&(l.current={customer_id:t},u(s+1))}),[t]),r.a.createElement(o.a,{responseDataHandle:a,api:"admin-wxinfo/v1/customerwxinfo",method:"get",reqParams:l.current,reqObject:i.current,requestCount:s})};i.defaultProps={customerId:0,responseDataHandle:function(e){console.log(e)}}},m7Th:function(e,t,a){"use strict";a("f3/d"),a("xfY5"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("Z2Ku"),a("L9s1");var n=a("q1tI"),r=a.n(n),o=a("5rEg"),c=a("2fM7"),s=a("zeV3"),u=a("2/Rp"),l=a("tsqr"),i=(a("a1Th"),a("91GP"),a("Vl3Y")),m=a("kLXV"),d=a("nMFz"),f=a("vpoQ"),b=["id","name","mobile","email","wx_openid","people_id","address","custormer_category","avatar","add_time","update_time","explains","is_valid","purchase_total_counts"],p={name:"",mobile:"",email:"",people_id:"",address:"",custormer_category:1,avatar:"",explains:"",is_valid:!0},O=["id","customer_id","wx_nickname","memo_name","wx_session_key","wx_openid","wx_avatar","wx_country","wx_province","wx_city","wx_gender","add_time","update_time","explains"],v=["id","customer_id","wx_session_key","wx_openid","add_time","update_time","purchase_total_counts","wx_avatar","avatar"],_={id:"ID",name:"姓名",mobile:"手机",email:"E-Mail",wx_openid:"微信openid",people_id:"身份证",address:"地址",custormer_category:"顾客级别",avatar:"头像url",add_time:"创建时间",update_time:"更新时间",explains:"说明",is_valid:"有效",purchase_total_counts:"订单总数",customer_id:"顾客ID",wx_session_key:"微信session key",wx_nickname:"微信昵称",wx_avatar:"微信头像url",wx_country:"国家",wx_province:"省",wx_city:"市",wx_gender:"性别",memo_name:"备注名称"},E={is_valid:r.a.createElement(f.a,{options:[{value:!0,label:"有效"},{value:!1,label:"无效"}]}),custormer_category:r.a.createElement(f.a,{options:[{value:1,label:"一般顾客"},{value:2,label:"优质顾客"},{value:3,label:"VIP顾客"}]}),wx_gender:r.a.createElement(f.a,{options:[{value:0,label:"未知"},{value:1,label:"男"},{value:2,label:"女"}]})},j=["avatar","wx_avatar"],w=a("VYaB"),x=a("colo"),g=a("7BUj").a.formCommonStyle,h=g.layoutForm,y=g.formItemLayout,C=g.tailFormItemLayout,k=["id","wx_openid","avatar","add_time","update_time","purchase_total_counts"],q=function(e){var t=e.modalState,a=e.setModalState,c=e.responseDataHandle,f=i.a.useForm()[0],O=Object(n.useState)(!1),j=O[0],g=O[1],q=Object(n.useRef)({}),S=Object(n.useRef)({}),I=Object(n.useState)(0),D=I[0],H=I[1],L=Object(n.useState)(0),R=L[0],M=L[1];Object(n.useEffect)((function(){!1===t&&f.setFieldsValue(Object.assign({},p))}),[t]);return r.a.createElement(m.a,{title:"创建顾客",getContainer:!1,visible:t,footer:null,closable:!1},r.a.createElement(x.a,{spinning:j}),r.a.createElement("div",{className:"avatar-box"},r.a.createElement(d.a,{uploadedResponseHandle:function(e,t){var a="";Object.keys(e).includes("image_cos_name")?a=e.image_cos_name:(M(R+1),l.a.error("Upload fail..."),l.a.error("上传失败")),q.current={avatar:a}},avatarSize:64,fileKey:"avatar",cleanFileListCount:R})),r.a.createElement(i.a,Object.assign({},h,{form:f,layout:"horizontal",onFinish:function(e){g(!0),S.current=Object.assign({},e,q.current),H(D+1)},name:"dynamic_rule"}),b.map((function(e){if(k.includes(e))return null;var t=v.includes(e),a=_[e];return r.a.createElement(i.a.Item,Object.assign({},y,{name:e,label:a,key:e.toString(),initialValue:p[e]}),Object.keys(E).includes(e)?E[e]:r.a.createElement(o.a,{placeholder:"请输入 "+a,disabled:t}))})),r.a.createElement(i.a.Item,C,r.a.createElement(s.a,null,r.a.createElement(u.a,{type:"primary",htmlType:"submit"},"创建"),r.a.createElement(u.a,{onClick:function(){a(!1)}},"取消"))),r.a.createElement(i.a.Item,null,r.a.createElement(w.a,{requestCount:D,reqObject:S.current,responseDataHandle:function(e){g(!1),c(e)}}))))};q.defaultProps={modalState:!1,setModalState:function(e){console.log(e)},responseDataHandle:function(e){console.log(e)}};var S=q,I=a("VXEj"),D=(a("9wds"),{labelCol:{span:6},wrapperCol:{span:18}}),H={labelCol:{xs:{span:12},sm:{span:10}},wrapperCol:{xs:{span:12},sm:{span:14}}},L={wrapperCol:{xs:{span:24,offset:2},sm:{span:16,offset:8}}},R=function(e){var t=e.customerInfoObj,a=e.infoOrWx,c=e.showListOrDetail,s=Object(n.useState)(!1),m=s[0],f=s[1],b=Object(n.useState)({}),p=b[0],O=b[1],g=Object(n.useState)(""),h=g[0],y=g[1],C=Object(n.useState)(0),k=C[0],q=(C[1],Object(n.useRef)("")),S=Object(n.useRef)(!1),I=Object(n.useRef)({}),R=Object(n.useState)(0),M=R[0],B=R[1];Object(n.useEffect)((function(){console.log(t),O(t);var e=a>0?t.wx_avatar:t.avatar;return y(e),function(){return null}}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{spinning:m}),r.a.createElement("div",{className:"avatar-box"},0===a?r.a.createElement(d.a,{oldImageUrl:h,avatarSize:64,uploadedResponseHandle:function(e,t){console.log(t),S.current=!0,Object.keys(e).includes("image_cos_name")&&e.image_cos_name.length>10?q.current=e.image_cos_name:(q.current="",y(""))},cleanFileListCount:k}):r.a.createElement("img",{src:h,alt:"Avatar",height:"64px"})),r.a.createElement(i.a,Object.assign({},D,{layout:"horizontal",onFinish:function(e){f(!0);var t=Object.assign({},e);S.current&&0===a&&(t.avatar=q.current),console.log(t),O(e),I.current=t,B(M+1)},name:"customer_info_edit"}),Object.keys(p).map((function(e){if(j.includes(e))return null;var a=v.includes(e),n=_[e],c=t[e];return r.a.createElement(i.a.Item,Object.assign({},H,{name:e,label:n,key:e.toString(),initialValue:c}),Object.keys(E).includes(e)?E[e]:r.a.createElement(o.a,{placeholder:"请输入 "+n,disabled:a}))})),r.a.createElement(i.a.Item,L,r.a.createElement(u.a,{type:"primary",htmlType:"submit"},"修改"),"  ",r.a.createElement(u.a,{onClick:function(){c(0)}},"取消")),r.a.createElement(i.a.Item,null,r.a.createElement(w.b,{customerOrWx:a,customerOrWxId:t.id,requestCount:M,reqObject:I.current,responseDataHandle:function(e){f(!1);try{console.log(e),l.a.success("Success!"),l.a.success("更新成功(Success)!"),setTimeout((function(){c(0)}),1e3)}catch(t){console.log(t),l.a.error("Error..."),l.a.error("Error: 网络错误...")}}}))))},M=function(e){var t=e.customerOrWxInfoObj,a=e.showListOrDetail,n=Object.keys(t),o=!0,c=!0;if(n.forEach((function(e){b.includes(e)||(o=!1),O.includes(e)||(c=!1)})),o&&c)return console.log("Customer object error, too many keys..."),null;if(!o&&!c)return console.log("Customer object error, all keys error..."),null;var s=o?0:1;return r.a.createElement(R,{customerInfoObj:t,infoOrWx:s,showListOrDetail:a})};M.defaultProps={customerOrWxInfoObj:{},showListOrDetail:function(e){console.log("This is Form page! value: "+e)}};var B=M,P=a("scZm"),W=function(e){var t=e.sendGetRequest;return e.showLoadMoreButton?r.a.createElement("div",{style:{textAlign:"center",marginTop:12,height:32,lineHeight:"32px"}},r.a.createElement(u.a,{onClick:t},"loading more")):null},G=function(e){var t=e.customerData,a=e.sendGetRequest,o=e.showLoadMoreButton,c=e.selectCustomerHandle,s=e.showListCount,l=Object(n.useState)(0),i=l[0],m=l[1],d=Object(n.useState)({}),f=d[0],b=d[1],p=function(e,t){void 0===t&&(t={}),e>0&&b(t),m(e)};return Object(n.useEffect)((function(){p(0)}),[s]),i<1?r.a.createElement(I.b,{itemLayout:"vertical",loadMore:r.a.createElement(W,{sendGetRequest:a,showLoadMoreButton:o}),dataSource:t,renderItem:function(e){return r.a.createElement(I.b.Item,{actions:[r.a.createElement(u.a,{onClick:function(){return c(e)},type:"link"},"选择"),r.a.createElement(u.a,{onClick:function(){p(1,e)},type:"link"},"顾客详情")]},r.a.createElement(I.b.Item.Meta,{avatar:r.a.createElement(P.a,{width:64,alt:"Image",src:e.wx_avatar}),title:e.wx_nickname+" 住址: "+e.wx_province+" "+e.wx_city+"; 备注名: "+e.memo_name,description:"备注: "+e.explains}))}}):r.a.createElement(B,{customerOrWxInfoObj:f,showListOrDetail:p})},V=function(e){var t=e.customerData,a=e.sendGetRequest,o=e.showLoadMoreButton,c=e.selectCustomerHandle,s=e.showListCount,l=Object(n.useState)(0),i=l[0],m=l[1],d=Object(n.useState)({}),f=d[0],b=d[1],p=function(e,t){void 0===t&&(t={}),e>0&&b(t),m(e)};return Object(n.useEffect)((function(){console.log("changed: "+s),p(0)}),[s]),i<1?r.a.createElement(I.b,{itemLayout:"vertical",loadMore:r.a.createElement(W,{sendGetRequest:a,showLoadMoreButton:o}),dataSource:t,renderItem:function(e){return r.a.createElement(I.b.Item,{actions:[r.a.createElement(u.a,{onClick:function(){return c(e)},type:"link"},"选择"),r.a.createElement(u.a,{onClick:function(){p(1,e)},type:"link"},"顾客详情")]},r.a.createElement(I.b.Item.Meta,{avatar:r.a.createElement(P.a,{width:64,alt:"Image",src:e.avatar}),title:"姓名: "+e.name+", 手机: "+e.mobile+", 住址: "+e.address+";",description:"备注: "+e.explains}))}}):r.a.createElement(B,{customerOrWxInfoObj:f,showListOrDetail:p})},F=function(e){var t=e.customerData,a=e.wxOrInfo,n=e.sendGetRequest,o=e.showLoadMoreButton,c=e.selectCustomerHandle,s=e.showListCount;return a>0?r.a.createElement(V,{customerData:t,sendGetRequest:n,showLoadMoreButton:o,selectCustomerHandle:c,showListCount:s}):r.a.createElement(G,{customerData:t,sendGetRequest:n,showLoadMoreButton:o,selectCustomerHandle:c,showListCount:s})};F.defaultProps={customerData:[],wxOrInfo:0,sendGetRequest:null,showLoadMoreButton:!0,selectCustomerHandle:function(e){console.log(e);var t=Object.keys(e).includes("name")?e.name:Object.keys(e).includes("wx_nickname")?e.wx_nickname:"Error Object";l.a.info("Selected "+t+" !"),l.a.info("选择了 "+t+" !")},showListCount:0};var T=F,z=a("Sm+g"),N=o.a.Search,Y=c.a.Option,U=function(e){var t,a=e.selectCustomerHandle,o=e.clickCreatedCustomerHandle,l=Object(n.useState)(!1),i=l[0],m=l[1],d=Object(n.useState)(0),f=d[0],b=d[1],p=Object(n.useRef)(""),O=Object(n.useState)([]),v=O[0],_=O[1],E=Object(n.useRef)("wx_nickname"),j=Object(n.useState)(0),w=j[0],x=j[1],g=Object(n.useRef)(0),h=Object(n.useRef)(1),y=Object(n.useState)(!0),C=y[0],k=y[1],q=Object(n.useRef)("admin-wxinfo/v1/customerwxinfo"),I=Object(n.useRef)(((t={})[E.current]="",t.page=g,t)),D=Object(n.useState)(0),H=D[0],L=D[1],R=function(){var e;if(g.current=g.current+1,g.current>h.current)return k(!1),void console.log("Not more...");k(!0);var t=((e={})[E.current]=p.current,e.page=g.current,e);I.current=t,L(H+1)};return r.a.createElement("div",null,r.a.createElement(S,{modalState:i,setModalState:m,responseDataHandle:function(e){o(e),m(!1)}}),r.a.createElement(s.a,null,r.a.createElement(c.a,{defaultValue:"wx_nickname",style:{width:120},onChange:function(e){E.current=e;var t=[].concat(["admin-wxinfo/v1/customerwxinfo","admin-customer/v1/customer"]);_([]),"wx_nickname"===e?(q.current=t[0],x(0)):(q.current=t[1],x(1))}},r.a.createElement(Y,{value:"wx_nickname"},"微信昵称"),r.a.createElement(Y,{value:"name"},"顾客姓名"),r.a.createElement(Y,{value:"mobile"},"手机号码")),r.a.createElement(u.a,{type:"link",onClick:function(){m(!0)}},"新建顾客")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(N,{placeholder:"搜索顾客微信昵称",onSearch:function(e){b(f+1),_([]),g.current=0,h.current=1,p.current=e,R()},enterButton:!0}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(T,{selectCustomerHandle:a,customerData:v,wxOrInfo:w,sendGetRequest:R,showLoadMoreButton:C,showListCount:f}),r.a.createElement("br",null),r.a.createElement(z.a,{responseDataHandle:function(e){if(Object.keys(e).includes("code")&&1e3===e.code){var t=v.concat(e.results);if(_(t),e.count&&void 0!==e.count){var a=Math.ceil(Number(e.count)/10);h.current=a}else h.current=1}else console.log("Error Request: ",e)},api:q.current,method:"get",reqParams:I.current,reqObject:{},requestCount:H}))};U.defaultProps={selectCustomerHandle:function(e){console.log(e);var t=Object.keys(e).includes("name")?e.name:Object.keys(e).includes("wx_nickname")?e.wx_nickname:"Error Object";l.a.info("Selected "+t+" !"),l.a.info("选择了 "+t+" !")},clickCreatedCustomerHandle:function(e){console.log(e)}};t.a=U}}]);
//# sourceMappingURL=1fbddbfdaae7b40ce59c09bafe734eb963daeb33-6a046468b26d31d10335.js.map